import{f as V,z as $,r as o,D as X,E as J,j as e,G as U,I as M,J as Q,h as L,B as y,P as W,T as Y,t as T,c as Z}from"./index-4020e339.js";import{L as ee,B as se}from"./BaseStoreDashboard-0e39fc73.js";import te from"./OverviewTab-30ffe364.js";import{I}from"./input-72252c3d.js";import{S as ae,a as re,b as oe,c as ie,d as ne}from"./select-31cdb233.js";import{D as ce,a as le,b as de,c as me}from"./dialog-d2829896.js";import{L as E}from"./label-dfea19c8.js";import"./textarea-6e954f6a.js";import{u as ue,a as he}from"./index-cb56a7ed.js";import{C as pe}from"./check-8b5d22b0.js";import{B as xe}from"./badge-54788017.js";import{T as fe,a as be,b as A,c as S,d as je,e as P}from"./table-3562d8f8.js";import{useStoreDashboard as ge}from"./useStoreDashboard-092a1cc0.js";import{S as z}from"./shopping-cart-ad832388.js";import{S as ke}from"./search-90c48c54.js";import{P as ve}from"./pencil-5a5480e6.js";import ye from"./OrdersTab-e6190215.js";import{BulkUploadTab as Ce}from"./BulkUploadTab-c21a8eac.js";import Ne from"./FinancialsTab-ae36bb23.js";import Se from"./AdminTab-a5eee867.js";import Pe from"./ProfileTab-bdc8470c.js";import{U as we}from"./upload-c1efbb4a.js";import{D as Ie,S as Ee}from"./settings-3a739b87.js";import{U as De}from"./users-dec98a74.js";import"./Helmet-966781f7.js";import"./log-out-30241d86.js";import"./index-a6eb7b0d.js";import"./triangle-alert-30e3235d.js";import"./card-cc9cfd5e.js";import"./package-1cc03608.js";import"./trending-up-36728e9d.js";import"./clock-f4d06a64.js";import"./truck-45a9dcb6.js";import"./map-pin-865d1b33.js";import"./circle-alert-dc75c245.js";import"./credit-card-bea94bde.js";import"./user-plus-36b776d9.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],Re=V("barcode",Te);var _="Checkbox",[Be,Cs]=$(_),[_e,Me]=Be(_),O=o.forwardRef((t,c)=>{const{__scopeCheckbox:i,name:m,checked:g,defaultChecked:r,required:u,disabled:h,value:C="on",onCheckedChange:p,form:x,...N}=t,[l,k]=o.useState(null),a=X(c,n=>k(n)),d=o.useRef(!1),D=l?x||!!l.closest("form"):!0,[f=!1,w]=J({prop:g,defaultProp:r,onChange:p}),R=o.useRef(f);return o.useEffect(()=>{const n=l==null?void 0:l.form;if(n){const v=()=>w(R.current);return n.addEventListener("reset",v),()=>n.removeEventListener("reset",v)}},[l,w]),e.jsxs(_e,{scope:i,state:f,disabled:h,children:[e.jsx(U.button,{type:"button",role:"checkbox","aria-checked":j(f)?"mixed":f,"aria-required":u,"data-state":H(f),"data-disabled":h?"":void 0,disabled:h,value:C,...N,ref:a,onKeyDown:M(t.onKeyDown,n=>{n.key==="Enter"&&n.preventDefault()}),onClick:M(t.onClick,n=>{w(v=>j(v)?!0:!v),D&&(d.current=n.isPropagationStopped(),d.current||n.stopPropagation())})}),D&&e.jsx(Le,{control:l,bubbles:!d.current,name:m,value:C,checked:f,required:u,disabled:h,form:x,style:{transform:"translateX(-100%)"},defaultChecked:j(r)?!1:r})]})});O.displayName=_;var q="CheckboxIndicator",K=o.forwardRef((t,c)=>{const{__scopeCheckbox:i,forceMount:m,...g}=t,r=Me(q,i);return e.jsx(Q,{present:m||j(r.state)||r.state===!0,children:e.jsx(U.span,{"data-state":H(r.state),"data-disabled":r.disabled?"":void 0,...g,ref:c,style:{pointerEvents:"none",...t.style}})})});K.displayName=q;var Le=t=>{const{control:c,checked:i,bubbles:m=!0,defaultChecked:g,...r}=t,u=o.useRef(null),h=ue(i),C=he(c);o.useEffect(()=>{const x=u.current,N=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(N,"checked").set;if(h!==i&&k){const a=new Event("click",{bubbles:m});x.indeterminate=j(i),k.call(x,j(i)?!1:i),x.dispatchEvent(a)}},[h,i,m]);const p=o.useRef(j(i)?!1:i);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??p.current,...r,tabIndex:-1,ref:u,style:{...t.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function j(t){return t==="indeterminate"}function H(t){return j(t)?"indeterminate":t?"checked":"unchecked"}var F=O,Ae=K;const Ue=o.forwardRef(({className:t,...c},i)=>e.jsx(F,{ref:i,className:L("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...c,children:e.jsx(Ae,{className:L("flex items-center justify-center text-current"),children:e.jsx(pe,{className:"h-4 w-4"})})}));Ue.displayName=F.displayName;const ze=()=>{const{products:t,fetchProducts:c,addProduct:i,updateProduct:m,deleteProduct:g,store:r}=ge(),[u,h]=o.useState(""),[C,p]=o.useState(!1),[x,N]=o.useState(!1),[l,k]=o.useState(null),[a,d]=o.useState({name:"",price:"",stock:"",description:"",category:"Abarrotes",sku:"",image_url:""});o.useEffect(()=>{r!=null&&r.id&&c(r.id)},[r==null?void 0:r.id,c]);const D=t.filter(s=>s.name.toLowerCase().includes(u.toLowerCase())||s.sku&&s.sku.includes(u)),f=["Abarrotes","Lácteos","Carnes","Frutas/Verduras","Limpieza","Bebidas","Cuidado Personal"],w=()=>{k(null),d({name:"",price:"",stock:"50",description:"",category:"Abarrotes",sku:"",image_url:""}),p(!0)},R=s=>{k(s),d({name:s.name,price:s.price,stock:s.stock,description:s.description||"",category:s.category||"Abarrotes",sku:s.sku||"",image_url:s.image_url||""}),p(!0)},n=async(s,b)=>{try{await m(s.id,{stock:parseInt(b)}),T({title:"Stock actualizado"})}catch{}},v=async s=>{s.preventDefault(),N(!0);try{const b={name:a.name,price:parseFloat(a.price),stock:parseInt(a.stock),sku:a.sku,description:a.sku?`${a.description}

SKU:${a.sku}`:a.description,category:a.category,store_id:r==null?void 0:r.id,product_type:"physical",requires_shipping:!0};l?(await m(l.id,b),T({title:"Producto actualizado"})):(await i(b),T({title:"Producto registrado"})),p(!1)}catch{T({title:"Error",variant:"destructive"})}finally{N(!1)}},G=async s=>{confirm("¿Eliminar producto?")&&await g(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 p-6 rounded-t-xl flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-emerald-900 flex items-center gap-2",children:[e.jsx(z,{className:"h-8 w-8 text-emerald-600"}),"Inventario Máster"]}),e.jsx("p",{className:"text-emerald-700",children:"Gestión masiva de referencias, precios y existencias."})]}),e.jsxs(y,{className:"bg-emerald-700 hover:bg-emerald-800",onClick:w,children:[e.jsx(W,{className:"h-4 w-4 mr-2"})," Nuevo Producto"]})]}),e.jsxs("div",{className:"flex gap-4 items-center bg-white p-2 border-b",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{placeholder:"Buscar por nombre, código de barras...",className:"pl-10",value:u,onChange:s=>h(s.target.value)})]}),e.jsxs(y,{variant:"outline",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"})," Escanear"]})]}),e.jsx("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:e.jsxs(fe,{children:[e.jsx(be,{children:e.jsxs(A,{className:"bg-gray-50",children:[e.jsx(S,{className:"w-[100px]",children:"Código/SKU"}),e.jsx(S,{children:"Producto"}),e.jsx(S,{children:"Categoría"}),e.jsx(S,{className:"text-right",children:"Precio"}),e.jsx(S,{className:"text-center w-[150px]",children:"Stock"}),e.jsx(S,{className:"text-right",children:"Acciones"})]})}),e.jsx(je,{children:D.map(s=>{var b,B;return e.jsxs(A,{children:[e.jsx(P,{className:"font-mono text-xs text-gray-500",children:s.sku||((B=(b=s.description)==null?void 0:b.match(/SKU:(\w+)/))==null?void 0:B[1])||"---"}),e.jsx(P,{className:"font-medium text-slate-800",children:s.name}),e.jsx(P,{children:e.jsx(xe,{variant:"outline",className:"font-normal",children:s.category})}),e.jsxs(P,{className:"text-right font-bold text-emerald-700",children:["$",Number(s.price).toLocaleString()]}),e.jsx(P,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{variant:"ghost",className:"h-6 w-6 rounded-full p-0",onClick:()=>n(s,Math.max(0,s.stock-1)),children:"-"}),e.jsx("span",{className:"w-8 text-center",children:s.stock}),e.jsx(y,{variant:"ghost",className:"h-6 w-6 rounded-full p-0",onClick:()=>n(s,s.stock+1),children:"+"})]})}),e.jsxs(P,{className:"text-right",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>R(s),children:e.jsx(ve,{className:"h-4 w-4 text-blue-500"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>G(s.id),children:e.jsx(Y,{className:"h-4 w-4 text-red-500"})})]})]},s.id)})})]})}),e.jsx(ce,{open:C,onOpenChange:p,children:e.jsxs(le,{children:[e.jsx(de,{children:e.jsx(me,{children:"Producto de Supermercado"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(E,{children:"Nombre Producto"}),e.jsx(I,{value:a.name,onChange:s=>d({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Código Barras / SKU"}),e.jsx(I,{value:a.sku,onChange:s=>d({...a,sku:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Categoría"}),e.jsxs(ae,{value:a.category,onValueChange:s=>d({...a,category:s}),children:[e.jsx(re,{children:e.jsx(oe,{})}),e.jsx(ie,{children:f.map(s=>e.jsx(ne,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Precio"}),e.jsx(I,{type:"number",value:a.price,onChange:s=>d({...a,price:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Stock Inicial"}),e.jsx(I,{type:"number",value:a.stock,onChange:s=>d({...a,stock:s.target.value}),required:!0})]})]}),e.jsx(y,{type:"submit",className:"w-full bg-emerald-600 hover:bg-emerald-700",disabled:x,children:"Guardar"})]})]})})]})},Ns=o.memo(({store:t})=>{const c=[{path:"",label:"Resumen",icon:ee,element:e.jsx(te,{storeId:t.id})},{path:"inventario",label:"Inventario",icon:z,element:e.jsx(ze,{})},{path:"pedidos",label:"Pedidos",icon:Z,element:e.jsx(ye,{storeId:t.id})},{path:"importar",label:"Carga Masiva",icon:we,element:e.jsx(Ce,{storeId:t.id,onProductsUploaded:()=>{}})},{path:"finanzas",label:"Caja",icon:Ie,element:e.jsx(Ne,{storeId:t.id})},{path:"equipo",label:"Cajeros",icon:De,element:e.jsx(Se,{storeId:t.id})},{path:"configuracion",label:"Ajustes",icon:Ee,element:e.jsx(Pe,{})}];return e.jsx(se,{store:t,tabs:c})});export{Ns as default};
