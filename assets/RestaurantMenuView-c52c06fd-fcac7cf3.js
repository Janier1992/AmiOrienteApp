import{S as P,b as i,y as e,x as f,F as U,q as G,i as H,H as X,J as Z,A as J,d as K,X as Q,p as R,_ as c,w as E}from"./index-4834c6e1.js";import{l as p}from"./input-977568de-bea10295.js";import{k as W,O as Y,V as ee,I as ae,M as se}from"./select-03f52418-c5111b6c.js";import{u as n}from"./label-6ced007b-31f64b09.js";import{t as te}from"./textarea-03a75c76-69040bf5.js";import{F as A}from"./switch-4dcb0898-6baf1f34.js";import{d as re}from"./badge-34bdff7c-b2c90fce.js";import{u as le}from"./useStoreDashboard-6cfa5bdd-a014cfe4.js";import{o as oe}from"./search-566f00ed-c3babbf0.js";import{a as ie}from"./utensils-crossed-8251ba29-3d1f84c7.js";import{c as ce}from"./pencil-b145156d-81e39600.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],de=P("chef-hat",ne);/**
* @license lucide-react v0.561.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const me=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],xe=P("flame",me);/**
* @license lucide-react v0.561.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const ge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],he=P("image",ge),ue=({product:t,onEdit:g,onDelete:b,onToggleAvailability:h})=>{const o=t.stock>0;return e.jsxs(K,{className:`rounded-3xl overflow-hidden border-0 shadow-md hover:shadow-xl transition-all group bg-white h-full flex flex-col ${o?"":"opacity-80 grayscale"}`,children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsxs("div",{className:"w-full h-full bg-orange-50 flex flex-col items-center justify-center text-orange-300",children:[e.jsx(ie,{className:"h-12 w-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold",children:"Sin foto"})]}),e.jsx("div",{className:"absolute top-3 left-3 z-20",children:e.jsx(re,{variant:o?"default":"destructive",className:o?"bg-green-500 hover:bg-green-600":"bg-red-500",children:o?"Disponible":"Agotado"})}),e.jsxs("div",{className:"absolute bottom-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity translate-y-2 group-hover:translate-y-0 duration-300 z-20",children:[e.jsx(f,{variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-lg bg-white/90 backdrop-blur text-orange-600 hover:bg-white",onClick:r=>{r.stopPropagation(),g(t)},children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(f,{variant:"destructive",size:"icon",className:"h-9 w-9 rounded-full shadow-lg",onClick:r=>{r.stopPropagation(),b(t.id)},children:e.jsx(Q,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"}),e.jsxs("div",{className:"absolute bottom-3 left-3 text-white",children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-0.5 text-orange-200",children:t.category}),e.jsx("h3",{className:"font-bold text-lg leading-tight shadow-sm",children:t.name})]})]}),e.jsxs(R,{className:"p-4 flex-1 flex flex-col justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3",children:t.description})}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-3 border-t border-orange-50",children:[e.jsxs("span",{className:"text-xl font-extrabold text-slate-800",children:["$",Number(t.price).toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{htmlFor:`stock-${t.id}`,className:"text-xs text-gray-400 cursor-pointer",children:"Activo"}),e.jsx(A,{id:`stock-${t.id}`,checked:o,onCheckedChange:()=>h(t),className:"data-[state=checked]:bg-green-500"})]})]})]})]})},_e=()=>{const{products:t,fetchProducts:g,addProduct:b,updateProduct:h,deleteProduct:o,store:r}=le(),[C,F]=i.useState(""),[z,u]=i.useState(!1),[_,S]=i.useState(!1),[j,y]=i.useState(null),[l,d]=i.useState({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""}),[v,N]=i.useState(null);i.useEffect(()=>{r!=null&&r.id&&g(r.id)},[r==null?void 0:r.id,g]);const $=t.filter(a=>a.name.toLowerCase().includes(C.toLowerCase())),D=["Entradas","Platos Fuertes","Bebidas","Postres","Adicionales"],q=()=>{y(null),d({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""}),N(null),u(!0)},M=a=>{y(a),d({name:a.name,price:a.price,description:a.description||"",category:a.category||"Platos Fuertes",stock:a.stock>0,image_url:a.image_url||""}),N(null),u(!0)},w=a=>{const{name:s,value:m}=a.target;d(x=>({...x,[s]:m}))},L=a=>{a.target.files&&a.target.files[0]&&N(a.target.files[0])},O=async(a,s,m)=>{const{error:x,data:k}=await E.storage.from(s).upload(m,a);if(x)throw new Error(`Error upload: ${x.message}`);const{data:B}=E.storage.from(s).getPublicUrl(k.path);return B.publicUrl},I=async a=>{a.preventDefault(),S(!0);try{let s=l.image_url;if(v&&r!=null&&r.id){const x=v.name.replace(/[^a-zA-Z0-9.]/g,"_"),k=`${r.id}/${Date.now()}_menu_${x}`;s=await O(v,"product-images",k)}const m={name:l.name,price:parseFloat(l.price),stock:l.stock?100:0,product_type:"physical",requires_shipping:!1,image_url:s,description:l.description,category:l.category,store_id:r==null?void 0:r.id};j?(await h(j.id,m),c({title:"Plato actualizado"})):(await b(m),c({title:"Plato añadido al menú"})),u(!1),y(null),d({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""})}catch(s){console.error(s),c({title:"Error",variant:"destructive"})}finally{S(!1)}},T=async a=>{const s=a.stock>0?0:100;try{await h(a.id,{stock:s}),c({title:s>0?"Plato marcado como disponible":"Plato marcado como agotado"})}catch{c({title:"Error al actualizar estado",variant:"destructive"})}},V=async a=>{if(window.confirm("¿Eliminar del menú?"))try{await o(a),c({title:"Eliminado"})}catch{c({title:"Error",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-8 font-sans",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-100 p-8 rounded-3xl flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-extrabold text-orange-900 flex items-center gap-3",children:[e.jsx(de,{className:"h-10 w-10 text-orange-600"}),"Gestión del Menú"]}),e.jsx("p",{className:"text-orange-800 mt-2 text-lg",children:"Organiza tus platos, precios y disponibilidad en tiempo real."})]}),e.jsxs(f,{className:"bg-orange-600 text-white hover:bg-orange-700 rounded-full px-8 py-6 text-md font-bold shadow-orange-200 shadow-xl",onClick:q,children:[e.jsx(U,{className:"h-5 w-5 mr-2"})," Agregar Plato"]})]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center bg-white p-2 rounded-2xl shadow-sm border border-slate-100 relative z-10",children:e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(oe,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(p,{placeholder:"Buscar en el menú...",className:"pl-12 border-0 bg-slate-50 rounded-xl focus:bg-white transition-all py-6 text-lg",value:C,onChange:a=>F(a.target.value)})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:$.map(a=>e.jsx(ue,{product:{...a,discount:0},onEdit:M,onDelete:V,onToggleAvailability:T},a.id))}),$.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(xe,{className:"h-16 w-16 mb-4 text-orange-200"}),e.jsx("p",{className:"text-xl font-medium",children:"Tu menú está vacío."}),e.jsx("p",{children:"Agrega deliciosos platos para tus clientes."})]}),e.jsx(G,{open:z,onOpenChange:u,children:e.jsxs(H,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto rounded-3xl",children:[e.jsx(X,{children:e.jsx(Z,{className:"text-2xl font-bold text-orange-950 flex items-center gap-2",children:j?"Editar Plato":"Nuevo Plato"})}),e.jsxs("form",{onSubmit:I,className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(n,{className:"text-orange-900 font-bold",children:"Nombre del Plato"}),e.jsx(p,{name:"name",value:l.name,onChange:w,placeholder:"Ej: Hamburguesa Artesanal",className:"rounded-xl border-orange-200 focus:border-orange-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-orange-900 font-bold",children:"Precio"}),e.jsx(p,{name:"price",type:"number",value:l.price,onChange:w,className:"rounded-xl border-orange-200 focus:border-orange-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-orange-900 font-bold",children:"Categoría"}),e.jsxs(W,{name:"category",value:l.category,onValueChange:a=>d(s=>({...s,category:a})),children:[e.jsx(Y,{className:"rounded-xl border-orange-200",children:e.jsx(ee,{})}),e.jsx(ae,{children:D.map(a=>e.jsx(se,{value:a,children:a},a))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-orange-900 font-bold",children:"Foto del Plato"}),e.jsxs("div",{className:"border-2 border-dashed border-orange-200 rounded-2xl p-4 flex flex-col items-center gap-4 bg-orange-50/50 hover:bg-orange-50 transition-colors",children:[l.image_url?e.jsx("img",{src:l.image_url,alt:"Preview",className:"h-32 w-full object-cover rounded-xl shadow-md"}):e.jsx(he,{className:"h-10 w-10 text-orange-300"}),e.jsx(p,{type:"file",accept:"image/*",onChange:L,className:"max-w-xs"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-orange-900 font-bold",children:"Descripción / Ingredientes"}),e.jsx(te,{name:"description",value:l.description,onChange:w,placeholder:"Describe los ingredientes y la preparación...",className:"rounded-xl border-orange-200 min-h-[100px]"})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-xl",children:[e.jsx(n,{className:"cursor-pointer",htmlFor:"stock-toggle",children:"¿Disponible para ordenar hoy?"}),e.jsx(A,{id:"stock-toggle",checked:l.stock,onCheckedChange:a=>d(s=>({...s,stock:a}))})]}),e.jsx(f,{type:"submit",className:"w-full bg-orange-600 text-white rounded-xl py-6 font-bold text-lg hover:bg-orange-700 shadow-lg shadow-orange-200",disabled:_,children:_?e.jsx(J,{className:"animate-spin"}):"Guardar en el Menú"})]})]})})]})};export{_e as S,de as d};
