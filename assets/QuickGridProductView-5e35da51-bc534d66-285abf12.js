import{x as I,d as n,y as e,h as L,f as M,p as P,J as F,b as J,m as q,E as k}from"./index-8e3c4911.js";import{a as m}from"./input-977568de-bea10295-4adb3258.js";import{o as A,d as B,f as h,b as x,m as D,i as c}from"./table-d515a05c-fec441de-a95c27a2.js";import{u as G}from"./useStoreDashboard-6cfa5bdd-a014cfe4-c8bff8db.js";import{d as S}from"./badge-34bdff7c-b2c90fce-efd43af8.js";import{l as H}from"./circle-alert-58769497-aeae36dd-aab7d564.js";import{o as R}from"./save-155183cf-7e3b99a3-0ccc9220.js";import{o as V}from"./search-566f00ed-c3babbf0-ad60b5b7.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],O=I("refresh-cw",K),ee=({storeId:l})=>{const{products:i,fetchProducts:u,updateProduct:$}=G(),[d,f]=n.useState([]),[g,z]=n.useState(""),[s,j]=n.useState(new Set),[N,v]=n.useState(!1),[C,y]=n.useState(!1);n.useEffect(()=>{l&&(y(!0),u(l).finally(()=>y(!1)))},[l,u]),n.useEffect(()=>{(i.length>0&&d.length===0||i.length>0&&s.size===0)&&f(i)},[i,s.size]);const p=(a,t,r)=>{f(o=>o.map(b=>b.id===a?{...b,[t]:r}:b)),j(o=>new Set(o).add(a))},E=async()=>{if(s.size!==0){v(!0);try{const a=Array.from(s).map(t=>{const r=d.find(o=>o.id===t);return{id:r.id,price:parseFloat(r.price),stock:parseInt(r.stock),name:r.name}});for(const t of a){const{id:r,...o}=t;await $(r,o)}k({title:"Inventario actualizado",description:`${a.length} productos guardados.`}),j(new Set),u(l)}catch(a){console.error(a),k({title:"Error",description:"No se pudieron guardar algunos cambios.",variant:"destructive"})}finally{v(!1)}}},w=d.filter(a=>a.name.toLowerCase().includes(g.toLowerCase()));return e.jsxs(L,{className:"h-full border-none shadow-sm",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xl",children:"Inventario Rápido"}),e.jsx(F,{children:"Edita precios y stock directamente como en una hoja de cálculo."})]}),e.jsxs("div",{className:"flex gap-2",children:[s.size>0&&e.jsxs("div",{className:"flex items-center text-amber-600 bg-amber-50 px-3 py-1 rounded-md text-sm font-medium animate-pulse",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),s.size," cambios sin guardar"]}),e.jsxs(J,{onClick:E,disabled:N||s.size===0,className:`${s.size>0?"bg-green-600 hover:bg-green-700":"bg-gray-200 text-gray-400"}`,children:[N?e.jsx(O,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(R,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]}),e.jsxs(q,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(V,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Filtar productos...",value:g,onChange:a=>z(a.target.value),className:"pl-8 bg-gray-50 border-gray-200"})]})}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(A,{children:[e.jsx(B,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(x,{className:"w-[40%]",children:"Producto"}),e.jsx(x,{className:"w-[20%]",children:"Precio"}),e.jsx(x,{className:"w-[20%]",children:"Stock"}),e.jsx(x,{className:"w-[20%] text-right",children:"Estado"})]})}),e.jsx(D,{children:C&&d.length===0?e.jsx(h,{children:e.jsx(c,{colSpan:4,className:"h-24 text-center",children:"Cargando..."})}):w.length===0?e.jsx(h,{children:e.jsx(c,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No hay productos."})}):w.map(a=>{const t=s.has(a.id);return e.jsxs(h,{className:t?"bg-amber-50/50":"",children:[e.jsx(c,{className:"font-medium p-2",children:e.jsx(m,{value:a.name,onChange:r=>p(a.id,"name",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2"})}),e.jsx(c,{className:"p-2",children:e.jsx(m,{type:"number",value:a.price,onChange:r=>p(a.id,"price",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-right font-mono"})}),e.jsx(c,{className:"p-2",children:e.jsx(m,{type:"number",value:a.stock,onChange:r=>p(a.id,"stock",r.target.value),className:`border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-center ${a.stock<5?"text-red-600 font-bold":""}`})}),e.jsx(c,{className:"text-right p-2",children:t?e.jsx(S,{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50",children:"Editado"}):e.jsx(S,{variant:"outline",className:"border-gray-200 text-gray-500",children:"Sincronizado"})})]},a.id)})})]})})]})]})};export{ee as default};
