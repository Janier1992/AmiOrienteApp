import{l as f,k as d,Q as T,r as y,j as e,C as j,a as v,b as w,B as h,c as _,t as b,P as S,R as m,_ as u}from"./index-7593522e.js";import{B as E}from"./BulkUploadTab-3e25ba5e.js";import{L as k,B as q}from"./BaseStoreDashboard-e6c3d8a1.js";import{B as g}from"./badge-aa6603fa.js";import{s as P}from"./useStoreDashboard-6e1233c7.js";import{C as L,R as O}from"./RestaurantMenuView-0777dcb1.js";import R from"./GenericPOSView-837e2cc5.js";import"./input-30c35c11.js";import"./label-a4c1a31d.js";import{C as I}from"./circle-check-big-e18572b1.js";import{C as B}from"./calendar-b7473a00.js";import{C as M}from"./credit-card-a50d43c9.js";import{U as z}from"./utensils-crossed-d46d12ac.js";import{U as A}from"./upload-7019e91d.js";import{D as V,S as D}from"./settings-030bd9e5.js";import{U}from"./users-1e3e6770.js";import"./circle-alert-9e1a28d8.js";import"./Helmet-c26e192a.js";import"./log-out-8e22b546.js";import"./index-bd02b651.js";import"./triangle-alert-0cea0848.js";import"./select-f8f9a097.js";import"./check-d1d3ff5a.js";import"./textarea-d838bc32.js";import"./switch-e312fcab.js";import"./index-dcb504c2.js";import"./search-34f7aa01.js";import"./pencil-fe5409bf.js";import"./scroll-area-305a242e.js";import"./shopping-cart-539ff770.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],F=f("layout-grid",G);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],C=f("wrench",H),p={async getTables(a){const{data:i,error:r}=await d.from("restaurant_tables").select("*").eq("store_id",a).order("number");if(r)throw r;return i},async createTable(a){const{data:i,error:r}=await d.from("restaurant_tables").insert(a).select().single();if(r)throw r;return i},async updateTableStatus(a,i){const{error:r}=await d.from("restaurant_tables").update({status:i}).eq("id",a);if(r)throw r},async createPOSTransaction({orderPayload:a,items:i}){const{data:r,error:t}=await d.from("orders").insert(a).select().single();if(t)throw t;const n=i.map(o=>({order_id:r.id,product_id:o.id,quantity:o.qty,price:o.price})),{error:s}=await d.from("order_items").insert(n);if(s)throw console.error("Error creating items",s),s;return r}},N=T((a,i)=>({tables:[],products:[],cart:[],isLoadingTables:!1,isLoadingCheckout:!1,error:null,addToCart:r=>{const t=i().cart,n=t.find(s=>s.id===r.id);if(n){if(r.stock!==void 0&&n.qty>=r.stock)return!1;a({cart:t.map(s=>s.id===r.id?{...s,qty:s.qty+1}:s)})}else a({cart:[...t,{...r,qty:1}]});return!0},removeFromCart:r=>{a(t=>({cart:t.cart.filter(n=>n.id!==r)}))},updateCartQty:(r,t)=>{a(n=>({cart:n.cart.map(s=>{if(s.id===r){const o=Math.max(1,s.qty+t);return t>0&&s.stock!==void 0&&o>s.stock?s:{...s,qty:o}}return s})}))},clearCart:()=>a({cart:[]}),processCheckout:async(r,t,n,s)=>{const o=i().cart;if(o.length===0)return;const x=typeof t=="object"?{name:t.name,doc_id:t.docId,phone:t.phone,email:t.email,method:n,type:"POS"}:{name:t,method:n,type:"POS"};a({isLoadingCheckout:!0});try{const c={store_id:r,customer_id:null,status:"Entregado",total:s,delivery_address:JSON.stringify({guest:x,items:o.map(l=>({id:l.id,name:l.name,qty:l.qty,price:l.price}))})};return await p.createPOSTransaction({orderPayload:c,items:o}),i().clearCart(),!0}catch(c){throw c}finally{a({isLoadingCheckout:!1})}},fetchTables:async r=>{a({isLoadingTables:!0,error:null});try{const t=await p.getTables(r);a({tables:t})}catch(t){a({error:t.message})}finally{a({isLoadingTables:!1})}},addTable:async r=>{try{const t=await p.createTable(r);return a(n=>({tables:[...n.tables,t]})),t}catch(t){throw t}},toggleTableStatus:async(r,t)=>{const n=t==="available"?"occupied":"available",s=i().tables;a({tables:s.map(o=>o.id===r?{...o,status:n}:o)});try{await p.updateTableStatus(r,n)}catch(o){throw a({tables:s}),o}},fetchProducts:async r=>{try{const t=await P.getProducts(r);a({products:t})}catch(t){console.error("Error fetching products for POS:",t)}}})),Q=({storeId:a})=>{const{tables:i,fetchTables:r,addTable:t,toggleTableStatus:n,isLoadingTables:s,error:o}=N();y.useEffect(()=>{a&&r(a)},[a,r]);const x=async()=>{const c=prompt("Número de mesa:");if(c)try{await t({store_id:a,number:c,capacity:4}),b({title:"Mesa agregada"})}catch(l){b({title:"Error",description:l.message,variant:"destructive"})}};return s&&i.length===0?e.jsx("div",{className:"p-4",children:"Cargando mesas..."}):e.jsxs(j,{children:[e.jsxs(v,{className:"flex flex-row items-center justify-between",children:[e.jsx(w,{children:"Gestión de Mesas"}),e.jsx(h,{onClick:x,children:"+ Agregar Mesa"})]}),e.jsxs(_,{children:[o&&e.jsxs("p",{className:"text-red-500 mb-4",children:["Error: ",o]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[i.map(c=>e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${c.status==="occupied"?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,onClick:()=>n(c.id,c.status),children:[e.jsx("div",{className:"text-2xl font-bold text-center mb-2",children:c.number}),e.jsx(g,{variant:c.status==="occupied"?"destructive":"default",className:"w-full justify-center",children:c.status==="occupied"?"Ocupada":"Libre"})]},c.id)),i.length===0&&!s&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Agrega mesas para gestionarlas aquí."})]})]})]})},$=()=>{const[a,i]=y.useState([{id:1,name:"Horno Industrial A",lastService:"2023-11-15",nextService:"2024-01-15",status:"ok"},{id:2,name:"Nevera Carnes",lastService:"2023-10-01",nextService:"2023-12-01",status:"urgent"},{id:3,name:"Batidora 20L",lastService:"2023-12-01",nextService:"2024-03-01",status:"ok"}]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-100 p-6 rounded-2xl",children:[e.jsxs("h1",{className:"text-3xl font-extrabold text-orange-900 flex items-center gap-3",children:[e.jsx(C,{className:"h-8 w-8 text-orange-600"}),"Mantenimiento de Equipos"]}),e.jsx("p",{className:"text-orange-800 mt-2",children:"Gestiona el estado y cronograma de mantenimiento de tu maquinaria para evitar paradas."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{className:"bg-orange-600 hover:bg-orange-700",children:[e.jsx(S,{className:"h-4 w-4 mr-2"})," Registrar Equipo"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(r=>e.jsxs(j,{className:"border-l-4 border-l-orange-500 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(v,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(w,{className:"text-lg font-bold text-gray-800",children:r.name}),r.status==="ok"?e.jsx(g,{className:"bg-green-100 text-green-700 hover:bg-green-100 border-none",children:"Operativo"}):e.jsx(g,{className:"bg-red-100 text-red-700 hover:bg-red-100 border-none animate-pulse",children:"Servicio Req."})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(I,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{children:["Último: ",r.lastService]})]}),e.jsxs("div",{className:`flex items-center font-medium ${r.status==="urgent"?"text-red-600":"text-blue-600"}`,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Próximo: ",r.nextService]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100 flex gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Bitácora"}),e.jsx(h,{size:"sm",className:"w-full text-xs bg-slate-800 text-white",children:"Programar"})]})]})]},r.id))})]})},J=m.lazy(()=>u(()=>import("./OverviewTab-4d90d2b2.js"),["./OverviewTab-4d90d2b2.js","./index-7593522e.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./settings-030bd9e5.js","./package-8a53cd5c.js","./trending-up-6d925098.js"],import.meta.url)),K=m.lazy(()=>u(()=>import("./OrdersTab-bbdc2219.js"),["./OrdersTab-bbdc2219.js","./index-7593522e.js","./index-9e34f4e4.css","./badge-aa6603fa.js","./select-f8f9a097.js","./check-d1d3ff5a.js","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./package-8a53cd5c.js","./clock-87f27ea4.js","./truck-4de66a3b.js","./map-pin-4c971ad0.js"],import.meta.url)),W=m.lazy(()=>u(()=>import("./ProfileTab-b476a6ea.js"),["./ProfileTab-b476a6ea.js","./index-7593522e.js","./index-9e34f4e4.css","./input-30c35c11.js","./label-a4c1a31d.js","./useStoreDashboard-6e1233c7.js"],import.meta.url)),X=m.lazy(()=>u(()=>import("./AdminTab-383d089a.js"),["./AdminTab-383d089a.js","./index-7593522e.js","./index-9e34f4e4.css","./user-plus-413d81fa.js","./users-1e3e6770.js"],import.meta.url)),Y=m.lazy(()=>u(()=>import("./FinancialsTab-aa1c096f.js"),["./FinancialsTab-aa1c096f.js","./index-7593522e.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./settings-030bd9e5.js","./trending-up-6d925098.js","./credit-card-a50d43c9.js","./circle-alert-9e1a28d8.js"],import.meta.url)),ke=({store:a})=>{const i=[{path:"",label:"Resumen",icon:k,element:e.jsx(J,{storeId:a.id})},{path:"caja",label:"Caja",icon:M,element:e.jsx(R,{useStore:N,title:"Restaurante - Caja"})},{path:"pedidos",label:"Cocina y Pedidos",icon:L,element:e.jsx(K,{storeId:a.id})},{path:"menu",label:"Menú Digital",icon:z,element:e.jsx(O,{})},{path:"mesas",label:"Mesas",icon:F,element:e.jsx(Q,{storeId:a.id})},{path:"mantenimiento",label:"Mantenimiento",icon:C,element:e.jsx($,{})},{path:"importar",label:"Importar",icon:A,element:e.jsx(E,{storeId:a.id})},{path:"finanzas",label:"Finanzas",icon:V,element:e.jsx(Y,{storeId:a.id})},{path:"equipo",label:"Equipo",icon:U,element:e.jsx(X,{storeId:a.id})},{path:"configuracion",label:"Configuración",icon:D,element:e.jsx(W,{})}];return e.jsx(q,{store:a,tabs:i})};export{ke as default};
