import{k as $,f as c,y as e,m as L,g as M,v as P,e as F,w as q,a as A,h as k}from"./index-bea51c07.js";import{a as m}from"./input-977568de-bea10295-4adb3258-368f21ef.js";import{o as G,d as H,f as h,N as x,m as K,b as n}from"./table-d515a05c-fec441de-a95c27a2-dbafa435.js";import{u as O}from"./useStoreDashboard-6cfa5bdd-a014cfe4-c8bff8db-4123484f.js";import{d as S}from"./badge-34bdff7c-b2c90fce-efd43af8-f7a84e83.js";import{c as R}from"./circle-alert-58769497-aeae36dd-aab7d564-c8980787.js";import{o as T}from"./save-155183cf-7e3b99a3-0ccc9220-a34fca90.js";import{o as B}from"./search-566f00ed-c3babbf0-ad60b5b7-3e645f27.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],J=$("refresh-cw",D),ee=({storeId:d})=>{const{products:i,fetchProducts:u,updateProduct:z}=O(),[l,g]=c.useState([]),[j,C]=c.useState(""),[r,b]=c.useState(new Set),[N,v]=c.useState(!1),[E,y]=c.useState(!1);c.useEffect(()=>{d&&(y(!0),u(d).finally(()=>y(!1)))},[d,u]),c.useEffect(()=>{(i.length>0&&l.length===0||i.length>0&&r.size===0)&&g(i)},[i,r.size]);const p=(s,t,a)=>{g(o=>o.map(f=>f.id===s?{...f,[t]:a}:f)),b(o=>new Set(o).add(s))},I=async()=>{if(r.size!==0){v(!0);try{const s=Array.from(r).map(t=>{const a=l.find(o=>o.id===t);return{id:a.id,price:parseFloat(a.price),stock:parseInt(a.stock),name:a.name}});for(const t of s){const{id:a,...o}=t;await z(a,o)}k({title:"Inventario actualizado",description:`${s.length} productos guardados.`}),b(new Set),u(d)}catch(s){console.error(s),k({title:"Error",description:"No se pudieron guardar algunos cambios.",variant:"destructive"})}finally{v(!1)}}},w=l.filter(s=>s.name.toLowerCase().includes(j.toLowerCase()));return e.jsxs(L,{className:"h-full border-none shadow-sm",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xl",children:"Inventario Rápido"}),e.jsx(F,{children:"Edita precios y stock directamente como en una hoja de cálculo."})]}),e.jsxs("div",{className:"flex gap-2",children:[r.size>0&&e.jsxs("div",{className:"flex items-center text-amber-600 bg-amber-50 px-3 py-1 rounded-md text-sm font-medium animate-pulse",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),r.size," cambios sin guardar"]}),e.jsxs(q,{onClick:I,disabled:N||r.size===0,className:`${r.size>0?"bg-green-600 hover:bg-green-700":"bg-gray-200 text-gray-400"}`,children:[N?e.jsx(J,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(T,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]}),e.jsxs(A,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(B,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Filtar productos...",value:j,onChange:s=>C(s.target.value),className:"pl-8 bg-gray-50 border-gray-200"})]})}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(G,{children:[e.jsx(H,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(x,{className:"w-[40%]",children:"Producto"}),e.jsx(x,{className:"w-[20%]",children:"Precio"}),e.jsx(x,{className:"w-[20%]",children:"Stock"}),e.jsx(x,{className:"w-[20%] text-right",children:"Estado"})]})}),e.jsx(K,{children:E&&l.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center",children:"Cargando..."})}):w.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No hay productos."})}):w.map(s=>{const t=r.has(s.id);return e.jsxs(h,{className:t?"bg-amber-50/50":"",children:[e.jsx(n,{className:"font-medium p-2",children:e.jsx(m,{value:s.name,onChange:a=>p(s.id,"name",a.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:s.price,onChange:a=>p(s.id,"price",a.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-right font-mono"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:s.stock,onChange:a=>p(s.id,"stock",a.target.value),className:`border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-center ${s.stock<5?"text-red-600 font-bold":""}`})}),e.jsx(n,{className:"text-right p-2",children:t?e.jsx(S,{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50",children:"Editado"}):e.jsx(S,{variant:"outline",className:"border-gray-200 text-gray-500",children:"Sincronizado"})})]},s.id)})})]})})]})]})};export{ee as default};
