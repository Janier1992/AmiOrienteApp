import{r as n,n as x,x as h,t as s,j as a,m as f,C as v,a as g,b as j,d as w,c as y,B as b,k as d}from"./index-9083a265.js";import{I as C}from"./input-f40b5322.js";import{K as N}from"./key-round-8157168e.js";import{L as z}from"./lock-d577cf19.js";const S=()=>{const[t,u]=n.useState(""),[i,o]=n.useState(!1),r=x(),{session:c}=h(),m=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;n.useEffect(()=>{c||window.location.hash.includes("access_token")||(s({title:"Enlace inválido",description:"El enlace de recuperación de contraseña es inválido o ha expirado.",variant:"destructive"}),r("/recuperar-contrasena"))},[c,r]);const p=async e=>{if(e.preventDefault(),!m.test(t)){s({title:"Contraseña insegura",description:"La contraseña debe tener al menos 8 caracteres, incluir una mayúscula, una minúscula, un número y un caracter especial.",variant:"destructive"});return}o(!0);const{error:l}=await d.auth.updateUser({password:t});o(!1),l?s({title:"Error al actualizar",description:l.message,variant:"destructive"}):(s({title:"¡Contraseña actualizada!",description:"Tu contraseña ha sido cambiada con éxito. Por favor, inicia sesión."}),await d.auth.signOut(),r("/cliente/login"))};return a.jsx("div",{className:"min-h-screen auth-gradient flex items-center justify-center p-4",children:a.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:a.jsxs(v,{className:"w-full bg-card text-card-foreground border-border",children:[a.jsxs(g,{className:"text-center pb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(N,{className:"h-8 w-8 text-primary"})}),a.jsx(j,{className:"text-2xl font-bold",children:"Crea tu Nueva Contraseña"}),a.jsx(w,{children:"Ingresa una nueva contraseña segura para tu cuenta."})]}),a.jsx(y,{children:a.jsxs("form",{onSubmit:p,className:"space-y-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),a.jsx(C,{type:"password",name:"password",placeholder:"Nueva Contraseña",value:t,onChange:e=>u(e.target.value),required:!0,className:"pl-10"})]}),a.jsx(b,{type:"submit",className:"w-full",disabled:i,children:i?"Actualizando...":"Actualizar Contraseña"})]})})]})})})};export{S as default};
