import{S as f,u as k,s as m,Z as p,t as u,y as e,w as l,b as y,d as v,f as w,h as _,x as h,p as N,F as q,_ as j}from"./index-2ce94096.js";import{B as C}from"./BulkUploadTab-3e25ba5e-0feebfa1.js";import{R as E,_ as P}from"./BaseStoreDashboard-e6c3d8a1-4e64a417.js";import{d as g}from"./badge-aa6603fa-a4f8275d.js";import{s as I}from"./useStoreDashboard-6e1233c7-c0c33d1b.js";import{d as O,S as L}from"./RestaurantMenuView-0777dcb1-dfd93b95.js";import z from"./GenericPOSView-837e2cc5-c84fd532.js";import"./input-30c35c11-b44761b2.js";import"./label-a4c1a31d-e949b025.js";import{t as A}from"./circle-check-big-e18572b1-a21d79ae.js";import{c as D}from"./calendar-b7473a00-79351308.js";import{c as R}from"./credit-card-a50d43c9-92f7ec06.js";import{a as M}from"./utensils-crossed-d46d12ac-c44f5654.js";import{t as F}from"./upload-7019e91d-5c44e162.js";import{a as V,n as B}from"./settings-030bd9e5-67a41fef.js";import{r as G}from"./users-1e3e6770-1b81f4c4.js";import"./circle-alert-9e1a28d8-b20db8b3.js";import"./Helmet-c26e192a-711588c7.js";import"./log-out-8e22b546-d2fb474d.js";import"./index-bd02b651-8cbaad37.js";import"./triangle-alert-0cea0848-982fead7.js";import"./select-f8f9a097-f8aafdb0.js";import"./check-d1d3ff5a-31b10f76.js";import"./textarea-d838bc32-b9870e6c.js";import"./switch-e312fcab-e79e6118.js";import"./search-34f7aa01-f8dfb85b.js";import"./pencil-fe5409bf-721c7957.js";import"./scroll-area-305a242e-4c6bab7e.js";import"./shopping-cart-539ff770-43b9593e.js";import"./index-dcb504c2-12f47de7.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],J=f("layout-grid",H);/**
* @license lucide-react v0.561.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Q=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],S=f("wrench",Q),x={async getTables(a){const{data:i,error:t}=await l.from("restaurant_tables").select("*").eq("store_id",a).order("number");if(t)throw t;return i},async createTable(a){const{data:i,error:t}=await l.from("restaurant_tables").insert(a).select().single();if(t)throw t;return i},async updateTableStatus(a,i){const{error:t}=await l.from("restaurant_tables").update({status:i}).eq("id",a);if(t)throw t},async createPOSTransaction({orderPayload:a,items:i}){const{data:t,error:r}=await l.from("orders").insert(a).select().single();if(r)throw r;const n=i.map(o=>({order_id:t.id,product_id:o.id,quantity:o.qty,price:o.price})),{error:s}=await l.from("order_items").insert(n);if(s)throw console.error("Error creating items",s),s;return t}},T=k((a,i)=>({tables:[],products:[],cart:[],isLoadingTables:!1,isLoadingCheckout:!1,error:null,addToCart:t=>{const r=i().cart,n=r.find(s=>s.id===t.id);if(n){if(t.stock!==void 0&&n.qty>=t.stock)return!1;a({cart:r.map(s=>s.id===t.id?{...s,qty:s.qty+1}:s)})}else a({cart:[...r,{...t,qty:1}]});return!0},removeFromCart:t=>{a(r=>({cart:r.cart.filter(n=>n.id!==t)}))},updateCartQty:(t,r)=>{a(n=>({cart:n.cart.map(s=>{if(s.id===t){const o=Math.max(1,s.qty+r);return r>0&&s.stock!==void 0&&o>s.stock?s:{...s,qty:o}}return s})}))},clearCart:()=>a({cart:[]}),processCheckout:async(t,r,n,s)=>{const o=i().cart;if(o.length===0)return;const b=typeof r=="object"?{name:r.name,doc_id:r.docId,phone:r.phone,email:r.email,method:n,type:"POS"}:{name:r,method:n,type:"POS"};a({isLoadingCheckout:!0});try{const c={store_id:t,customer_id:null,status:"Entregado",total:s,delivery_address:JSON.stringify({guest:b,items:o.map(d=>({id:d.id,name:d.name,qty:d.qty,price:d.price}))})};return await x.createPOSTransaction({orderPayload:c,items:o}),i().clearCart(),!0}catch(c){throw c}finally{a({isLoadingCheckout:!1})}},fetchTables:async t=>{a({isLoadingTables:!0,error:null});try{const r=await x.getTables(t);a({tables:r})}catch(r){a({error:r.message})}finally{a({isLoadingTables:!1})}},addTable:async t=>{try{const r=await x.createTable(t);return a(n=>({tables:[...n.tables,r]})),r}catch(r){throw r}},toggleTableStatus:async(t,r)=>{const n=r==="available"?"occupied":"available",s=i().tables;a({tables:s.map(o=>o.id===t?{...o,status:n}:o)});try{await x.updateTableStatus(t,n)}catch(o){throw a({tables:s}),o}},fetchProducts:async t=>{try{const r=await I.getProducts(t);a({products:r})}catch(r){console.error("Error fetching products for POS:",r)}}})),$=({storeId:a})=>{const{tables:i,fetchTables:t,addTable:r,toggleTableStatus:n,isLoadingTables:s,error:o}=T();y.useEffect(()=>{a&&t(a)},[a,t]);const b=async()=>{const c=prompt("Número de mesa:");if(c)try{await r({store_id:a,number:c,capacity:4}),j({title:"Mesa agregada"})}catch(d){j({title:"Error",description:d.message,variant:"destructive"})}};return s&&i.length===0?e.jsx("div",{className:"p-4",children:"Cargando mesas..."}):e.jsxs(v,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between",children:[e.jsx(_,{children:"Gestión de Mesas"}),e.jsx(h,{onClick:b,children:"+ Agregar Mesa"})]}),e.jsxs(N,{children:[o&&e.jsxs("p",{className:"text-red-500 mb-4",children:["Error: ",o]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[i.map(c=>e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${c.status==="occupied"?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,onClick:()=>n(c.id,c.status),children:[e.jsx("div",{className:"text-2xl font-bold text-center mb-2",children:c.number}),e.jsx(g,{variant:c.status==="occupied"?"destructive":"default",className:"w-full justify-center",children:c.status==="occupied"?"Ocupada":"Libre"})]},c.id)),i.length===0&&!s&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Agrega mesas para gestionarlas aquí."})]})]})]})},K=()=>{const[a,i]=y.useState([{id:1,name:"Horno Industrial A",lastService:"2023-11-15",nextService:"2024-01-15",status:"ok"},{id:2,name:"Nevera Carnes",lastService:"2023-10-01",nextService:"2023-12-01",status:"urgent"},{id:3,name:"Batidora 20L",lastService:"2023-12-01",nextService:"2024-03-01",status:"ok"}]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-100 p-6 rounded-2xl",children:[e.jsxs("h1",{className:"text-3xl font-extrabold text-orange-900 flex items-center gap-3",children:[e.jsx(S,{className:"h-8 w-8 text-orange-600"}),"Mantenimiento de Equipos"]}),e.jsx("p",{className:"text-orange-800 mt-2",children:"Gestiona el estado y cronograma de mantenimiento de tu maquinaria para evitar paradas."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{className:"bg-orange-600 hover:bg-orange-700",children:[e.jsx(q,{className:"h-4 w-4 mr-2"})," Registrar Equipo"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(t=>e.jsxs(v,{className:"border-l-4 border-l-orange-500 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(w,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(_,{className:"text-lg font-bold text-gray-800",children:t.name}),t.status==="ok"?e.jsx(g,{className:"bg-green-100 text-green-700 hover:bg-green-100 border-none",children:"Operativo"}):e.jsx(g,{className:"bg-red-100 text-red-700 hover:bg-red-100 border-none animate-pulse",children:"Servicio Req."})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(A,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{children:["Último: ",t.lastService]})]}),e.jsxs("div",{className:`flex items-center font-medium ${t.status==="urgent"?"text-red-600":"text-blue-600"}`,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Próximo: ",t.nextService]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100 flex gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",className:"w-full text-xs",children:"Bitácora"}),e.jsx(h,{size:"sm",className:"w-full text-xs bg-slate-800 text-white",children:"Programar"})]})]})]},t.id))})]})},W=m.lazy(()=>p(()=>u(()=>import("./OverviewTab-4d90d2b2-2472bb25.js"),["./OverviewTab-4d90d2b2-2472bb25.js","./index-2ce94096.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7-c0c33d1b.js","./index-bd02b651-8cbaad37.js","./triangle-alert-0cea0848-982fead7.js","./settings-030bd9e5-67a41fef.js","./package-8a53cd5c-b574c2fa.js","./trending-up-6d925098-59ad96bf.js"],import.meta.url),["./OverviewTab-4d90d2b2.js","./index-7593522e.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./settings-030bd9e5.js","./package-8a53cd5c.js","./trending-up-6d925098.js"],import.meta.url)),X=m.lazy(()=>p(()=>u(()=>import("./OrdersTab-bbdc2219-8f06d749.js"),["./OrdersTab-bbdc2219-8f06d749.js","./index-2ce94096.js","./index-9e34f4e4.css","./badge-aa6603fa-a4f8275d.js","./select-f8f9a097-f8aafdb0.js","./check-d1d3ff5a-31b10f76.js","./useStoreDashboard-6e1233c7-c0c33d1b.js","./index-bd02b651-8cbaad37.js","./triangle-alert-0cea0848-982fead7.js","./package-8a53cd5c-b574c2fa.js","./clock-87f27ea4-2e4bce74.js","./truck-4de66a3b-1e0700fb.js","./map-pin-4c971ad0-cfbd587c.js"],import.meta.url),["./OrdersTab-bbdc2219.js","./index-7593522e.js","./index-9e34f4e4.css","./badge-aa6603fa.js","./select-f8f9a097.js","./check-d1d3ff5a.js","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./package-8a53cd5c.js","./clock-87f27ea4.js","./truck-4de66a3b.js","./map-pin-4c971ad0.js"],import.meta.url)),Y=m.lazy(()=>p(()=>u(()=>import("./ProfileTab-b476a6ea-f55c5293.js"),["./ProfileTab-b476a6ea-f55c5293.js","./index-2ce94096.js","./index-9e34f4e4.css","./input-30c35c11-b44761b2.js","./label-a4c1a31d-e949b025.js","./useStoreDashboard-6e1233c7-c0c33d1b.js"],import.meta.url),["./ProfileTab-b476a6ea.js","./index-7593522e.js","./index-9e34f4e4.css","./input-30c35c11.js","./label-a4c1a31d.js","./useStoreDashboard-6e1233c7.js"],import.meta.url)),Z=m.lazy(()=>p(()=>u(()=>import("./AdminTab-383d089a-5b305ef9.js"),["./AdminTab-383d089a-5b305ef9.js","./index-2ce94096.js","./index-9e34f4e4.css","./user-plus-413d81fa-4edbf458.js","./users-1e3e6770-1b81f4c4.js"],import.meta.url),["./AdminTab-383d089a.js","./index-7593522e.js","./index-9e34f4e4.css","./user-plus-413d81fa.js","./users-1e3e6770.js"],import.meta.url)),U=m.lazy(()=>p(()=>u(()=>import("./FinancialsTab-aa1c096f-73719405.js"),["./FinancialsTab-aa1c096f-73719405.js","./index-2ce94096.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7-c0c33d1b.js","./index-bd02b651-8cbaad37.js","./triangle-alert-0cea0848-982fead7.js","./settings-030bd9e5-67a41fef.js","./trending-up-6d925098-59ad96bf.js","./credit-card-a50d43c9-92f7ec06.js","./circle-alert-9e1a28d8-b20db8b3.js"],import.meta.url),["./FinancialsTab-aa1c096f.js","./index-7593522e.js","./index-9e34f4e4.css","./useStoreDashboard-6e1233c7.js","./index-bd02b651.js","./triangle-alert-0cea0848.js","./settings-030bd9e5.js","./trending-up-6d925098.js","./credit-card-a50d43c9.js","./circle-alert-9e1a28d8.js"],import.meta.url)),Ee=({store:a})=>{const i=[{path:"",label:"Resumen",icon:E,element:e.jsx(W,{storeId:a.id})},{path:"caja",label:"Caja",icon:R,element:e.jsx(z,{useStore:T,title:"Restaurante - Caja"})},{path:"pedidos",label:"Cocina y Pedidos",icon:O,element:e.jsx(X,{storeId:a.id})},{path:"menu",label:"Menú Digital",icon:M,element:e.jsx(L,{})},{path:"mesas",label:"Mesas",icon:J,element:e.jsx($,{storeId:a.id})},{path:"mantenimiento",label:"Mantenimiento",icon:S,element:e.jsx(K,{})},{path:"importar",label:"Importar",icon:F,element:e.jsx(C,{storeId:a.id})},{path:"finanzas",label:"Finanzas",icon:V,element:e.jsx(U,{storeId:a.id})},{path:"equipo",label:"Equipo",icon:G,element:e.jsx(Z,{storeId:a.id})},{path:"configuracion",label:"Configuración",icon:B,element:e.jsx(Y,{})}];return e.jsx(P,{store:a,tabs:i})};export{Ee as default};
