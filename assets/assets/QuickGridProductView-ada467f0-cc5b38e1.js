import{S as I,b as c,y as e,d as L,f as M,h as P,G,x as F,p as _,_ as S}from"./index-2ce94096.js";import{l as m}from"./input-30c35c11-b44761b2.js";import{r as q,d as A,c as h,f as x,m as D,i as n}from"./table-4cf982c6-df9350bf.js";import{u as H}from"./useStoreDashboard-6e1233c7-c0c33d1b.js";import{d as k}from"./badge-aa6603fa-a4f8275d.js";import{l as Q}from"./circle-alert-9e1a28d8-b20db8b3.js";import{o as R}from"./save-61774bd3-0eefbd18.js";import{o as T}from"./search-34f7aa01-f8dfb85b.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],B=I("refresh-cw",V),ee=({storeId:d})=>{const{products:i,fetchProducts:u,updateProduct:z}=H(),[l,g]=c.useState([]),[j,C]=c.useState(""),[a,b]=c.useState(new Set),[N,v]=c.useState(!1),[$,y]=c.useState(!1);c.useEffect(()=>{d&&(y(!0),u(d).finally(()=>y(!1)))},[d,u]),c.useEffect(()=>{(i.length>0&&l.length===0||i.length>0&&a.size===0)&&g(i)},[i,a.size]);const p=(s,t,r)=>{g(o=>o.map(f=>f.id===s?{...f,[t]:r}:f)),b(o=>new Set(o).add(s))},E=async()=>{if(a.size!==0){v(!0);try{const s=Array.from(a).map(t=>{const r=l.find(o=>o.id===t);return{id:r.id,price:parseFloat(r.price),stock:parseInt(r.stock),name:r.name}});for(const t of s){const{id:r,...o}=t;await z(r,o)}S({title:"Inventario actualizado",description:`${s.length} productos guardados.`}),b(new Set),u(d)}catch(s){console.error(s),S({title:"Error",description:"No se pudieron guardar algunos cambios.",variant:"destructive"})}finally{v(!1)}}},w=l.filter(s=>s.name.toLowerCase().includes(j.toLowerCase()));return e.jsxs(L,{className:"h-full border-none shadow-sm",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xl",children:"Inventario Rápido"}),e.jsx(G,{children:"Edita precios y stock directamente como en una hoja de cálculo."})]}),e.jsxs("div",{className:"flex gap-2",children:[a.size>0&&e.jsxs("div",{className:"flex items-center text-amber-600 bg-amber-50 px-3 py-1 rounded-md text-sm font-medium animate-pulse",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),a.size," cambios sin guardar"]}),e.jsxs(F,{onClick:E,disabled:N||a.size===0,className:`${a.size>0?"bg-green-600 hover:bg-green-700":"bg-gray-200 text-gray-400"}`,children:[N?e.jsx(B,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(R,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]}),e.jsxs(_,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(T,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Filtar productos...",value:j,onChange:s=>C(s.target.value),className:"pl-8 bg-gray-50 border-gray-200"})]})}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(q,{children:[e.jsx(A,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(x,{className:"w-[40%]",children:"Producto"}),e.jsx(x,{className:"w-[20%]",children:"Precio"}),e.jsx(x,{className:"w-[20%]",children:"Stock"}),e.jsx(x,{className:"w-[20%] text-right",children:"Estado"})]})}),e.jsx(D,{children:$&&l.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center",children:"Cargando..."})}):w.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No hay productos."})}):w.map(s=>{const t=a.has(s.id);return e.jsxs(h,{className:t?"bg-amber-50/50":"",children:[e.jsx(n,{className:"font-medium p-2",children:e.jsx(m,{value:s.name,onChange:r=>p(s.id,"name",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:s.price,onChange:r=>p(s.id,"price",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-right font-mono"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:s.stock,onChange:r=>p(s.id,"stock",r.target.value),className:`border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-center ${s.stock<5?"text-red-600 font-bold":""}`})}),e.jsx(n,{className:"text-right p-2",children:t?e.jsx(k,{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50",children:"Editado"}):e.jsx(k,{variant:"outline",className:"border-gray-200 text-gray-500",children:"Sincronizado"})})]},s.id)})})]})})]})]})};export{ee as default};
