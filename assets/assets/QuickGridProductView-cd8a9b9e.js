import{l as L,r as n,j as e,C as P,a as B,b as M,d as R,B as I,c as H,t as C}from"./index-9083a265.js";import{I as m}from"./input-f40b5322.js";import{T as $,a as A,b as h,c as u,d as D,e as c}from"./table-9277bd3f.js";import{u as F}from"./useStoreDashboard-dac11d7b.js";import{B as S}from"./badge-29da9c44.js";import{C as G}from"./circle-alert-7ba7cf89.js";import{S as _}from"./save-12935dd3.js";import{S as q}from"./search-d5f724c4.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],V=L("refresh-cw",Q),ee=({storeId:l})=>{const{products:i,fetchProducts:x,updateProduct:k}=F(),[d,f]=n.useState([]),[g,T]=n.useState(""),[r,j]=n.useState(new Set),[v,N]=n.useState(!1),[z,w]=n.useState(!1);n.useEffect(()=>{l&&(w(!0),x(l).finally(()=>w(!1)))},[l,x]),n.useEffect(()=>{(i.length>0&&d.length===0||i.length>0&&r.size===0)&&f(i)},[i,r.size]);const p=(a,t,s)=>{f(o=>o.map(b=>b.id===a?{...b,[t]:s}:b)),j(o=>new Set(o).add(a))},E=async()=>{if(r.size!==0){N(!0);try{const a=Array.from(r).map(t=>{const s=d.find(o=>o.id===t);return{id:s.id,price:parseFloat(s.price),stock:parseInt(s.stock),name:s.name}});for(const t of a){const{id:s,...o}=t;await k(s,o)}C({title:"Inventario actualizado",description:`${a.length} productos guardados.`}),j(new Set),x(l)}catch(a){console.error(a),C({title:"Error",description:"No se pudieron guardar algunos cambios.",variant:"destructive"})}finally{N(!1)}}},y=d.filter(a=>a.name.toLowerCase().includes(g.toLowerCase()));return e.jsxs(P,{className:"h-full border-none shadow-sm",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(M,{className:"text-xl",children:"Inventario Rápido"}),e.jsx(R,{children:"Edita precios y stock directamente como en una hoja de cálculo."})]}),e.jsxs("div",{className:"flex gap-2",children:[r.size>0&&e.jsxs("div",{className:"flex items-center text-amber-600 bg-amber-50 px-3 py-1 rounded-md text-sm font-medium animate-pulse",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),r.size," cambios sin guardar"]}),e.jsxs(I,{onClick:E,disabled:v||r.size===0,className:`${r.size>0?"bg-green-600 hover:bg-green-700":"bg-gray-200 text-gray-400"}`,children:[v?e.jsx(V,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(_,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]}),e.jsxs(H,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(q,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Filtar productos...",value:g,onChange:a=>T(a.target.value),className:"pl-8 bg-gray-50 border-gray-200"})]})}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs($,{children:[e.jsx(A,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(u,{className:"w-[40%]",children:"Producto"}),e.jsx(u,{className:"w-[20%]",children:"Precio"}),e.jsx(u,{className:"w-[20%]",children:"Stock"}),e.jsx(u,{className:"w-[20%] text-right",children:"Estado"})]})}),e.jsx(D,{children:z&&d.length===0?e.jsx(h,{children:e.jsx(c,{colSpan:4,className:"h-24 text-center",children:"Cargando..."})}):y.length===0?e.jsx(h,{children:e.jsx(c,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No hay productos."})}):y.map(a=>{const t=r.has(a.id);return e.jsxs(h,{className:t?"bg-amber-50/50":"",children:[e.jsx(c,{className:"font-medium p-2",children:e.jsx(m,{value:a.name,onChange:s=>p(a.id,"name",s.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2"})}),e.jsx(c,{className:"p-2",children:e.jsx(m,{type:"number",value:a.price,onChange:s=>p(a.id,"price",s.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-right font-mono"})}),e.jsx(c,{className:"p-2",children:e.jsx(m,{type:"number",value:a.stock,onChange:s=>p(a.id,"stock",s.target.value),className:`border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-center ${a.stock<5?"text-red-600 font-bold":""}`})}),e.jsx(c,{className:"text-right p-2",children:t?e.jsx(S,{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50",children:"Editado"}):e.jsx(S,{variant:"outline",className:"border-gray-200 text-gray-500",children:"Sincronizado"})})]},a.id)})})]})})]})]})};export{ee as default};
