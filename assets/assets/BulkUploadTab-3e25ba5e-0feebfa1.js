import{S as M,b as n,y as e,l as p,a1 as D,d as R,f as T,h as z,p as O,x as u,a7 as q,_ as c,w as G}from"./index-2ce94096.js";import{t as S}from"./upload-7019e91d-5c44e162.js";import{l as H}from"./circle-alert-9e1a28d8-b20db8b3.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],V=M("file-text",U),B=D("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),_=n.forwardRef(({className:r,variant:l,...s},d)=>e.jsx("div",{ref:d,role:"alert",className:p(B({variant:l}),r),...s}));_.displayName="Alert";const A=n.forwardRef(({className:r,...l},s)=>e.jsx("h5",{ref:s,className:p("mb-1 font-medium leading-none tracking-tight",r),...l}));A.displayName="AlertTitle";const I=n.forwardRef(({className:r,...l},s)=>e.jsx("div",{ref:s,className:p("text-sm [&_p]:leading-relaxed",r),...l}));I.displayName="AlertDescription";const k=({onProductsUploaded:r,storeId:l})=>{const[s,d]=n.useState(null),[x,v]=n.useState(!1),[h,f]=n.useState([]),C=a=>{if(a.target.files&&a.target.files[0]){const t=a.target.files[0];t.type==="text/csv"||t.name.endsWith(".csv")?(d(t),E(t)):c({title:"Formato incorrecto",description:"Por favor, sube un archivo .csv",variant:"destructive"})}},E=a=>{const t=new FileReader;t.onload=m=>{const o=m.target.result.split(`
`).slice(1).filter(i=>i.trim()!=="").slice(0,3);f(o)},t.readAsText(a)},F=()=>{const a=encodeURI(`data:text/csv;charset=utf-8,name,description,price,category,stock,discount
Ejemplo Producto,Descripción del producto,15000,General,50,0`),t=document.createElement("a");t.setAttribute("href",a),t.setAttribute("download","plantilla_inventario.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t)},P=async()=>{if(!s||!l)return;v(!0);const a=new FileReader;a.onload=async t=>{try{const m=t.target.result.split(`
`).slice(1),o=[];for(const i of m){if(i.trim()==="")continue;const[g,b,j,y,N,w]=i.split(",");g&&j&&N&&o.push({store_id:l,name:g.trim(),description:(b==null?void 0:b.trim())||"",price:parseFloat(j)||0,category:(y==null?void 0:y.trim())||"General",stock:parseInt(N,10)||0,discount:w?parseFloat(w):0,product_type:"physical",requires_shipping:!0,created_at:new Date().toISOString()})}if(o.length>0){const{error:i}=await G.from("products").insert(o);i?c({title:"Error en la carga",description:i.message,variant:"destructive"}):(c({title:"¡Carga Exitosa!",description:`${o.length} productos han sido añadidos a tu inventario.`,className:"bg-green-50 border-green-200 text-green-800"}),r&&r(),d(null),f([]))}else c({title:"Archivo vacío",description:"No se encontraron datos válidos.",variant:"destructive"})}catch{c({title:"Error al procesar",description:"El archivo no tiene el formato correcto.",variant:"destructive"})}finally{v(!1)}},a.readAsText(s)};return e.jsxs(R,{children:[e.jsxs(T,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-primary"}),"Importación Masiva de Inventario"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sube tu inventario completo usando un archivo Excel (.csv)."})]}),e.jsxs(O,{className:"space-y-6",children:[e.jsxs(_,{className:"bg-blue-50 border-blue-200",children:[e.jsx(H,{className:"h-4 w-4 text-blue-600"}),e.jsx(A,{className:"text-blue-800",children:"Instrucciones"}),e.jsxs(I,{className:"text-blue-700 text-sm mt-1",children:["1. Descarga la plantilla de ejemplo.",e.jsx("br",{}),"2. Llena los datos de tus productos.",e.jsx("br",{}),"3. Guarda el archivo como .CSV.",e.jsx("br",{}),"4. Sube el archivo aquí."]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-200 rounded-lg p-8 bg-gray-50/50 hover:bg-gray-50 transition-colors",children:[e.jsx(S,{className:"h-10 w-10 text-gray-400 mb-4"}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(u,{variant:"outline",className:"pointer-events-none",tabIndex:-1,children:"Seleccionar Archivo"}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",accept:".csv",onChange:C})]}),e.jsxs(u,{variant:"ghost",onClick:F,className:"text-primary hover:text-primary/90",children:[e.jsx(q,{className:"mr-2 h-4 w-4"})," Descargar Plantilla"]})]}),s&&e.jsxs("div",{className:"w-full max-w-sm bg-white p-4 rounded border shadow-sm mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium text-sm mb-2",children:[e.jsx(V,{className:"h-4 w-4 text-blue-500"}),s.name]}),h.length>0&&e.jsx("div",{className:"text-xs text-gray-500 bg-gray-100 p-2 rounded font-mono",children:h.map((a,t)=>e.jsx("div",{className:"truncate",children:a},t))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{onClick:P,disabled:!s||x,className:"w-full sm:w-auto",children:x?"Procesando...":"Importar Productos"})})]})]})},$=Object.freeze(Object.defineProperty({__proto__:null,BulkUploadTab:k,default:k},Symbol.toStringTag,{value:"Module"}));export{k as B,V as F,$ as a};
