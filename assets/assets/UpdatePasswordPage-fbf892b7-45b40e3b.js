import{b as i,c as x,D as h,_ as e,y as a,E as f,d as v,f as j,h as w,G as y,p as N,x as b,w as d}from"./index-2ce94096.js";import{l as g}from"./input-30c35c11-b44761b2.js";import{c as S}from"./key-round-15a32f25-c970c620.js";import{t as C}from"./lock-83f51048-ce9008be.js";const D=()=>{const[s,u]=i.useState(""),[n,c]=i.useState(!1),t=x(),{session:l}=h(),m=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;i.useEffect(()=>{l||window.location.hash.includes("access_token")||(e({title:"Enlace inválido",description:"El enlace de recuperación de contraseña es inválido o ha expirado.",variant:"destructive"}),t("/recuperar-contrasena"))},[l,t]);const p=async r=>{if(r.preventDefault(),!m.test(s)){e({title:"Contraseña insegura",description:"La contraseña debe tener al menos 8 caracteres, incluir una mayúscula, una minúscula, un número y un caracter especial.",variant:"destructive"});return}c(!0);const{error:o}=await d.auth.updateUser({password:s});c(!1),o?e({title:"Error al actualizar",description:o.message,variant:"destructive"}):(e({title:"¡Contraseña actualizada!",description:"Tu contraseña ha sido cambiada con éxito. Por favor, inicia sesión."}),await d.auth.signOut(),t("/cliente/login"))};return a.jsx("div",{className:"min-h-screen auth-gradient flex items-center justify-center p-4",children:a.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:a.jsxs(v,{className:"w-full bg-card text-card-foreground border-border",children:[a.jsxs(j,{className:"text-center pb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(S,{className:"h-8 w-8 text-primary"})}),a.jsx(w,{className:"text-2xl font-bold",children:"Crea tu Nueva Contraseña"}),a.jsx(y,{children:"Ingresa una nueva contraseña segura para tu cuenta."})]}),a.jsx(N,{children:a.jsxs("form",{onSubmit:p,className:"space-y-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),a.jsx(g,{type:"password",name:"password",placeholder:"Nueva Contraseña",value:s,onChange:r=>u(r.target.value),required:!0,className:"pl-10"})]}),a.jsx(b,{type:"submit",className:"w-full",disabled:n,children:n?"Actualizando...":"Actualizar Contraseña"})]})})]})})})};export{D as default};
