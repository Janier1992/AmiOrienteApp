import{l as V,Z as G,r as o,$ as X,a0 as Q,j as e,a2 as U,a3 as M,a4 as Z,o as L,B as y,P as J,T as W,D as Y,v as ee,z as se,E as ae,t as D,g as te}from"./index-dc7f1cf1.js";import{L as re,B as oe}from"./BaseStoreDashboard-309f7a6b.js";import ie from"./OverviewTab-c3d5933b.js";import{I}from"./input-d4c7e221.js";import{S as ne,a as ce,b as le,c as de,d as me}from"./select-37a35d51.js";import{L as E}from"./label-21562bd6.js";import"./textarea-385c103a.js";import{u as ue,a as he}from"./index-94e0c0ef.js";import{C as pe}from"./check-0c83caba.js";import{B as xe}from"./badge-1d2a7dc0.js";import{T as fe,a as be,b as A,c as S,d as ge,e as P}from"./table-f619eeb8.js";import{useStoreDashboard as je}from"./useStoreDashboard-8587e03d.js";import{S as z}from"./shopping-cart-2f35db45.js";import{S as ke}from"./search-3987990a.js";import{P as ve}from"./pencil-d18f2cb4.js";import ye from"./OrdersTab-6c4e970e.js";import{BulkUploadTab as Ce}from"./BulkUploadTab-e757db06.js";import Ne from"./FinancialsTab-63001316.js";import Se from"./AdminTab-6fbdbfb1.js";import Pe from"./ProfileTab-209668f6.js";import{U as we}from"./upload-28ac7450.js";import{D as Ie,S as Ee}from"./settings-32dd1f84.js";import{U as Te}from"./users-f825be4c.js";import"./Helmet-4b27b46c.js";import"./log-out-92be1f5b.js";import"./index-b2f4b39b.js";import"./triangle-alert-32ee3fb6.js";import"./package-e8519bdc.js";import"./trending-up-9f29547c.js";import"./clock-8175ed76.js";import"./truck-044bfd35.js";import"./map-pin-10c801f4.js";import"./circle-alert-927ef83a.js";import"./credit-card-0c959c84.js";import"./user-plus-feae870f.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],Re=V("barcode",De);var _="Checkbox",[Be,vs]=G(_),[_e,Me]=Be(_),O=o.forwardRef((a,c)=>{const{__scopeCheckbox:i,name:m,checked:j,defaultChecked:r,required:u,disabled:h,value:C="on",onCheckedChange:p,form:x,...N}=a,[l,k]=o.useState(null),t=X(c,n=>k(n)),d=o.useRef(!1),T=l?x||!!l.closest("form"):!0,[f=!1,w]=Q({prop:j,defaultProp:r,onChange:p}),R=o.useRef(f);return o.useEffect(()=>{const n=l==null?void 0:l.form;if(n){const v=()=>w(R.current);return n.addEventListener("reset",v),()=>n.removeEventListener("reset",v)}},[l,w]),e.jsxs(_e,{scope:i,state:f,disabled:h,children:[e.jsx(U.button,{type:"button",role:"checkbox","aria-checked":g(f)?"mixed":f,"aria-required":u,"data-state":H(f),"data-disabled":h?"":void 0,disabled:h,value:C,...N,ref:t,onKeyDown:M(a.onKeyDown,n=>{n.key==="Enter"&&n.preventDefault()}),onClick:M(a.onClick,n=>{w(v=>g(v)?!0:!v),T&&(d.current=n.isPropagationStopped(),d.current||n.stopPropagation())})}),T&&e.jsx(Le,{control:l,bubbles:!d.current,name:m,value:C,checked:f,required:u,disabled:h,form:x,style:{transform:"translateX(-100%)"},defaultChecked:g(r)?!1:r})]})});O.displayName=_;var q="CheckboxIndicator",K=o.forwardRef((a,c)=>{const{__scopeCheckbox:i,forceMount:m,...j}=a,r=Me(q,i);return e.jsx(Z,{present:m||g(r.state)||r.state===!0,children:e.jsx(U.span,{"data-state":H(r.state),"data-disabled":r.disabled?"":void 0,...j,ref:c,style:{pointerEvents:"none",...a.style}})})});K.displayName=q;var Le=a=>{const{control:c,checked:i,bubbles:m=!0,defaultChecked:j,...r}=a,u=o.useRef(null),h=ue(i),C=he(c);o.useEffect(()=>{const x=u.current,N=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(N,"checked").set;if(h!==i&&k){const t=new Event("click",{bubbles:m});x.indeterminate=g(i),k.call(x,g(i)?!1:i),x.dispatchEvent(t)}},[h,i,m]);const p=o.useRef(g(i)?!1:i);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:j??p.current,...r,tabIndex:-1,ref:u,style:{...a.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function g(a){return a==="indeterminate"}function H(a){return g(a)?"indeterminate":a?"checked":"unchecked"}var F=O,Ae=K;const Ue=o.forwardRef(({className:a,...c},i)=>e.jsx(F,{ref:i,className:L("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...c,children:e.jsx(Ae,{className:L("flex items-center justify-center text-current"),children:e.jsx(pe,{className:"h-4 w-4"})})}));Ue.displayName=F.displayName;const ze=()=>{const{products:a,fetchProducts:c,addProduct:i,updateProduct:m,deleteProduct:j,store:r}=je(),[u,h]=o.useState(""),[C,p]=o.useState(!1),[x,N]=o.useState(!1),[l,k]=o.useState(null),[t,d]=o.useState({name:"",price:"",stock:"",description:"",category:"Abarrotes",sku:"",image_url:""});o.useEffect(()=>{r!=null&&r.id&&c(r.id)},[r==null?void 0:r.id,c]);const T=a.filter(s=>s.name.toLowerCase().includes(u.toLowerCase())||s.sku&&s.sku.includes(u)),f=["Abarrotes","Lácteos","Carnes","Frutas/Verduras","Limpieza","Bebidas","Cuidado Personal"],w=()=>{k(null),d({name:"",price:"",stock:"50",description:"",category:"Abarrotes",sku:"",image_url:""}),p(!0)},R=s=>{k(s),d({name:s.name,price:s.price,stock:s.stock,description:s.description||"",category:s.category||"Abarrotes",sku:s.sku||"",image_url:s.image_url||""}),p(!0)},n=async(s,b)=>{try{await m(s.id,{stock:parseInt(b)}),D({title:"Stock actualizado"})}catch{}},v=async s=>{s.preventDefault(),N(!0);try{const b={name:t.name,price:parseFloat(t.price),stock:parseInt(t.stock),sku:t.sku,description:t.sku?`${t.description}

SKU:${t.sku}`:t.description,category:t.category,store_id:r==null?void 0:r.id,product_type:"physical",requires_shipping:!0};l?(await m(l.id,b),D({title:"Producto actualizado"})):(await i(b),D({title:"Producto registrado"})),p(!1)}catch{D({title:"Error",variant:"destructive"})}finally{N(!1)}},$=async s=>{confirm("¿Eliminar producto?")&&await j(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-emerald-50 border border-emerald-100 p-6 rounded-t-xl flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-emerald-900 flex items-center gap-2",children:[e.jsx(z,{className:"h-8 w-8 text-emerald-600"}),"Inventario Máster"]}),e.jsx("p",{className:"text-emerald-700",children:"Gestión masiva de referencias, precios y existencias."})]}),e.jsxs(y,{className:"bg-emerald-700 hover:bg-emerald-800",onClick:w,children:[e.jsx(J,{className:"h-4 w-4 mr-2"})," Nuevo Producto"]})]}),e.jsxs("div",{className:"flex gap-4 items-center bg-white p-2 border-b",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{placeholder:"Buscar por nombre, código de barras...",className:"pl-10",value:u,onChange:s=>h(s.target.value)})]}),e.jsxs(y,{variant:"outline",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"})," Escanear"]})]}),e.jsx("div",{className:"bg-white border rounded-lg overflow-hidden shadow-sm",children:e.jsxs(fe,{children:[e.jsx(be,{children:e.jsxs(A,{className:"bg-gray-50",children:[e.jsx(S,{className:"w-[100px]",children:"Código/SKU"}),e.jsx(S,{children:"Producto"}),e.jsx(S,{children:"Categoría"}),e.jsx(S,{className:"text-right",children:"Precio"}),e.jsx(S,{className:"text-center w-[150px]",children:"Stock"}),e.jsx(S,{className:"text-right",children:"Acciones"})]})}),e.jsx(ge,{children:T.map(s=>{var b,B;return e.jsxs(A,{children:[e.jsx(P,{className:"font-mono text-xs text-gray-500",children:s.sku||((B=(b=s.description)==null?void 0:b.match(/SKU:(\w+)/))==null?void 0:B[1])||"---"}),e.jsx(P,{className:"font-medium text-slate-800",children:s.name}),e.jsx(P,{children:e.jsx(xe,{variant:"outline",className:"font-normal",children:s.category})}),e.jsxs(P,{className:"text-right font-bold text-emerald-700",children:["$",Number(s.price).toLocaleString()]}),e.jsx(P,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{variant:"ghost",className:"h-6 w-6 rounded-full p-0",onClick:()=>n(s,Math.max(0,s.stock-1)),children:"-"}),e.jsx("span",{className:"w-8 text-center",children:s.stock}),e.jsx(y,{variant:"ghost",className:"h-6 w-6 rounded-full p-0",onClick:()=>n(s,s.stock+1),children:"+"})]})}),e.jsxs(P,{className:"text-right",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>R(s),children:e.jsx(ve,{className:"h-4 w-4 text-blue-500"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>$(s.id),children:e.jsx(W,{className:"h-4 w-4 text-red-500"})})]})]},s.id)})})]})}),e.jsx(Y,{open:C,onOpenChange:p,children:e.jsxs(ee,{children:[e.jsx(se,{children:e.jsx(ae,{children:"Producto de Supermercado"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(E,{children:"Nombre Producto"}),e.jsx(I,{value:t.name,onChange:s=>d({...t,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Código Barras / SKU"}),e.jsx(I,{value:t.sku,onChange:s=>d({...t,sku:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Categoría"}),e.jsxs(ne,{value:t.category,onValueChange:s=>d({...t,category:s}),children:[e.jsx(ce,{children:e.jsx(le,{})}),e.jsx(de,{children:f.map(s=>e.jsx(me,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Precio"}),e.jsx(I,{type:"number",value:t.price,onChange:s=>d({...t,price:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Stock Inicial"}),e.jsx(I,{type:"number",value:t.stock,onChange:s=>d({...t,stock:s.target.value}),required:!0})]})]}),e.jsx(y,{type:"submit",className:"w-full bg-emerald-600 hover:bg-emerald-700",disabled:x,children:"Guardar"})]})]})})]})},ys=o.memo(({store:a})=>{const c=[{path:"",label:"Resumen",icon:re,element:e.jsx(ie,{storeId:a.id})},{path:"inventario",label:"Inventario",icon:z,element:e.jsx(ze,{})},{path:"pedidos",label:"Pedidos",icon:te,element:e.jsx(ye,{storeId:a.id})},{path:"importar",label:"Carga Masiva",icon:we,element:e.jsx(Ce,{storeId:a.id,onProductsUploaded:()=>{}})},{path:"finanzas",label:"Caja",icon:Ie,element:e.jsx(Ne,{storeId:a.id})},{path:"equipo",label:"Cajeros",icon:Te,element:e.jsx(Se,{storeId:a.id})},{path:"configuracion",label:"Ajustes",icon:Ee,element:e.jsx(Pe,{})}];return e.jsx(oe,{store:a,tabs:c})});export{ys as default};
