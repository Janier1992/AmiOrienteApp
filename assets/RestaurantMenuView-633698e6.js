import{f as k,r as n,j as e,B as f,P as V,b as H,T as R,t as c,e as E}from"./index-1004543a.js";import{C as G,c as Z}from"./card-2a69ef9f.js";import{I as p}from"./input-a76da225.js";import{S as J,a as K,b as Q,c as W,d as X}from"./select-0a8bce11.js";import{D as Y,a as ee,b as ae,c as se}from"./dialog-4e5e5dd7.js";import{L as d}from"./label-d8349a8f.js";import{T as te}from"./textarea-e00ca30c.js";import{S as F}from"./switch-08cbc454.js";import{B as re}from"./badge-1666b2ce.js";import{useStoreDashboard as le}from"./useStoreDashboard-597dd6f0.js";import{S as oe}from"./search-b4265b90.js";import{U as ie}from"./utensils-crossed-1aadad3b.js";import{P as ne}from"./pencil-1e3aeda4.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],de=k("chef-hat",ce);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],ge=k("flame",me);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],he=k("image",xe),ue=({product:r,onEdit:x,onDelete:b,onToggleAvailability:h})=>{const o=r.stock>0;return e.jsxs(G,{className:`rounded-3xl overflow-hidden border-0 shadow-md hover:shadow-xl transition-all group bg-white h-full flex flex-col ${o?"":"opacity-80 grayscale"}`,children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[r.image_url?e.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsxs("div",{className:"w-full h-full bg-orange-50 flex flex-col items-center justify-center text-orange-300",children:[e.jsx(ie,{className:"h-12 w-12 mb-2"}),e.jsx("span",{className:"text-xs font-bold",children:"Sin foto"})]}),e.jsx("div",{className:"absolute top-3 left-3 z-20",children:e.jsx(re,{variant:o?"default":"destructive",className:o?"bg-green-500 hover:bg-green-600":"bg-red-500",children:o?"Disponible":"Agotado"})}),e.jsxs("div",{className:"absolute bottom-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity translate-y-2 group-hover:translate-y-0 duration-300 z-20",children:[e.jsx(f,{variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-lg bg-white/90 backdrop-blur text-orange-600 hover:bg-white",onClick:s=>{s.stopPropagation(),x(r)},children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(f,{variant:"destructive",size:"icon",className:"h-9 w-9 rounded-full shadow-lg",onClick:s=>{s.stopPropagation(),b(r.id)},children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"}),e.jsxs("div",{className:"absolute bottom-3 left-3 text-white",children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-0.5 text-orange-200",children:r.category}),e.jsx("h3",{className:"font-bold text-lg leading-tight shadow-sm",children:r.name})]})]}),e.jsxs(Z,{className:"p-4 flex-1 flex flex-col justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3",children:r.description})}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-3 border-t border-orange-50",children:[e.jsxs("span",{className:"text-xl font-extrabold text-slate-800",children:["$",Number(r.price).toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{htmlFor:`stock-${r.id}`,className:"text-xs text-gray-400 cursor-pointer",children:"Activo"}),e.jsx(F,{id:`stock-${r.id}`,checked:o,onCheckedChange:()=>h(r),className:"data-[state=checked]:bg-green-500"})]})]})]})]})},De=()=>{const{products:r,fetchProducts:x,addProduct:b,updateProduct:h,deleteProduct:o,store:s}=le(),[C,A]=n.useState(""),[T,u]=n.useState(!1),[S,_]=n.useState(!1),[j,y]=n.useState(null),[l,m]=n.useState({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""}),[v,N]=n.useState(null);n.useEffect(()=>{s!=null&&s.id&&x(s.id)},[s==null?void 0:s.id,x]);const D=r.filter(a=>a.name.toLowerCase().includes(C.toLowerCase())),z=["Entradas","Platos Fuertes","Bebidas","Postres","Adicionales"],I=()=>{y(null),m({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""}),N(null),u(!0)},$=a=>{y(a),m({name:a.name,price:a.price,description:a.description||"",category:a.category||"Platos Fuertes",stock:a.stock>0,image_url:a.image_url||""}),N(null),u(!0)},w=a=>{const{name:t,value:i}=a.target;m(g=>({...g,[t]:i}))},M=a=>{a.target.files&&a.target.files[0]&&N(a.target.files[0])},L=async(a,t,i)=>{const{error:g,data:P}=await E.storage.from(t).upload(i,a);if(g)throw new Error(`Error upload: ${g.message}`);const{data:O}=E.storage.from(t).getPublicUrl(P.path);return O.publicUrl},q=async a=>{a.preventDefault(),_(!0);try{let t=l.image_url;if(v&&(s!=null&&s.id)){const g=v.name.replace(/[^a-zA-Z0-9.]/g,"_"),P=`${s.id}/${Date.now()}_menu_${g}`;t=await L(v,"product-images",P)}const i={name:l.name,price:parseFloat(l.price),stock:l.stock?100:0,product_type:"physical",requires_shipping:!1,image_url:t,description:l.description,category:l.category,store_id:s==null?void 0:s.id};j?(await h(j.id,i),c({title:"Plato actualizado"})):(await b(i),c({title:"Plato añadido al menú"})),u(!1),y(null),m({name:"",price:"",description:"",category:"Platos Fuertes",stock:!0,image_url:""})}catch(t){console.error(t),c({title:"Error",variant:"destructive"})}finally{_(!1)}},B=async a=>{const t=a.stock>0?0:100;try{await h(a.id,{stock:t}),c({title:t>0?"Plato marcado como disponible":"Plato marcado como agotado"})}catch{c({title:"Error al actualizar estado",variant:"destructive"})}},U=async a=>{if(window.confirm("¿Eliminar del menú?"))try{await o(a),c({title:"Eliminado"})}catch{c({title:"Error",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-8 font-sans",children:[e.jsxs("div",{className:"bg-orange-50 border border-orange-100 p-8 rounded-3xl flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-extrabold text-orange-900 flex items-center gap-3",children:[e.jsx(de,{className:"h-10 w-10 text-orange-600"}),"Gestión del Menú"]}),e.jsx("p",{className:"text-orange-800 mt-2 text-lg",children:"Organiza tus platos, precios y disponibilidad en tiempo real."})]}),e.jsxs(f,{className:"bg-orange-600 text-white hover:bg-orange-700 rounded-full px-8 py-6 text-md font-bold shadow-orange-200 shadow-xl",onClick:I,children:[e.jsx(V,{className:"h-5 w-5 mr-2"})," Agregar Plato"]})]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4 items-center bg-white p-2 rounded-2xl shadow-sm border border-slate-100 relative z-10",children:e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(oe,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(p,{placeholder:"Buscar en el menú...",className:"pl-12 border-0 bg-slate-50 rounded-xl focus:bg-white transition-all py-6 text-lg",value:C,onChange:a=>A(a.target.value)})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:D.map(a=>e.jsx(ue,{product:{...a,discount:0},onEdit:$,onDelete:U,onToggleAvailability:B},a.id))}),D.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(ge,{className:"h-16 w-16 mb-4 text-orange-200"}),e.jsx("p",{className:"text-xl font-medium",children:"Tu menú está vacío."}),e.jsx("p",{children:"Agrega deliciosos platos para tus clientes."})]}),e.jsx(Y,{open:T,onOpenChange:u,children:e.jsxs(ee,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto rounded-3xl",children:[e.jsx(ae,{children:e.jsx(se,{className:"text-2xl font-bold text-orange-950 flex items-center gap-2",children:j?"Editar Plato":"Nuevo Plato"})}),e.jsxs("form",{onSubmit:q,className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(d,{className:"text-orange-900 font-bold",children:"Nombre del Plato"}),e.jsx(p,{name:"name",value:l.name,onChange:w,placeholder:"Ej: Hamburguesa Artesanal",className:"rounded-xl border-orange-200 focus:border-orange-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"text-orange-900 font-bold",children:"Precio"}),e.jsx(p,{name:"price",type:"number",value:l.price,onChange:w,className:"rounded-xl border-orange-200 focus:border-orange-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"text-orange-900 font-bold",children:"Categoría"}),e.jsxs(J,{name:"category",value:l.category,onValueChange:a=>m(t=>({...t,category:a})),children:[e.jsx(K,{className:"rounded-xl border-orange-200",children:e.jsx(Q,{})}),e.jsx(W,{children:z.map(a=>e.jsx(X,{value:a,children:a},a))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"text-orange-900 font-bold",children:"Foto del Plato"}),e.jsxs("div",{className:"border-2 border-dashed border-orange-200 rounded-2xl p-4 flex flex-col items-center gap-4 bg-orange-50/50 hover:bg-orange-50 transition-colors",children:[l.image_url?e.jsx("img",{src:l.image_url,alt:"Preview",className:"h-32 w-full object-cover rounded-xl shadow-md"}):e.jsx(he,{className:"h-10 w-10 text-orange-300"}),e.jsx(p,{type:"file",accept:"image/*",onChange:M,className:"max-w-xs"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{className:"text-orange-900 font-bold",children:"Descripción / Ingredientes"}),e.jsx(te,{name:"description",value:l.description,onChange:w,placeholder:"Describe los ingredientes y la preparación...",className:"rounded-xl border-orange-200 min-h-[100px]"})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-xl",children:[e.jsx(d,{className:"cursor-pointer",htmlFor:"stock-toggle",children:"¿Disponible para ordenar hoy?"}),e.jsx(F,{id:"stock-toggle",checked:l.stock,onCheckedChange:a=>m(t=>({...t,stock:a}))})]}),e.jsx(f,{type:"submit",className:"w-full bg-orange-600 text-white rounded-xl py-6 font-bold text-lg hover:bg-orange-700 shadow-lg shadow-orange-200",disabled:S,children:S?e.jsx(H,{className:"animate-spin"}):"Guardar en el Menú"})]})]})})]})};export{de as C,De as R};
