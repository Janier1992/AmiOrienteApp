import{E as I,f as c,y as e,a as L,b as M,c as P,o as F,x as q,d as A,N as k}from"./index-87ab05f1.js";import{a as m}from"./input-977568de-bea10295-4adb3258-368f21ef-dd0395aa.js";import{o as D,d as G,f as h,N as x,m as H,b as n}from"./table-d515a05c-fec441de-a95c27a2-dbafa435-3628cfd7.js";import{u as J}from"./useStoreDashboard-6cfa5bdd-a014cfe4-c8bff8db-4123484f-ad5d382b.js";import{d as S}from"./badge-34bdff7c-b2c90fce-efd43af8-f7a84e83-2020d777.js";import{r as R}from"./circle-alert-58769497-aeae36dd-aab7d564-c8980787-32b03cc8.js";import{o as B}from"./save-155183cf-7e3b99a3-0ccc9220-a34fca90-eff0cdab.js";import{o as K}from"./search-566f00ed-c3babbf0-ad60b5b7-3e645f27-67335d64.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Q=I("refresh-cw",O),ee=({storeId:l})=>{const{products:d,fetchProducts:u,updateProduct:z}=J(),[i,g]=c.useState([]),[f,C]=c.useState(""),[s,j]=c.useState(new Set),[N,v]=c.useState(!1),[E,y]=c.useState(!1);c.useEffect(()=>{l&&(y(!0),u(l).finally(()=>y(!1)))},[l,u]),c.useEffect(()=>{(d.length>0&&i.length===0||d.length>0&&s.size===0)&&g(d)},[d,s.size]);const p=(a,t,r)=>{g(o=>o.map(b=>b.id===a?{...b,[t]:r}:b)),j(o=>new Set(o).add(a))},$=async()=>{if(s.size!==0){v(!0);try{const a=Array.from(s).map(t=>{const r=i.find(o=>o.id===t);return{id:r.id,price:parseFloat(r.price),stock:parseInt(r.stock),name:r.name}});for(const t of a){const{id:r,...o}=t;await z(r,o)}k({title:"Inventario actualizado",description:`${a.length} productos guardados.`}),j(new Set),u(l)}catch(a){console.error(a),k({title:"Error",description:"No se pudieron guardar algunos cambios.",variant:"destructive"})}finally{v(!1)}}},w=i.filter(a=>a.name.toLowerCase().includes(f.toLowerCase()));return e.jsxs(L,{className:"h-full border-none shadow-sm",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-xl",children:"Inventario Rápido"}),e.jsx(F,{children:"Edita precios y stock directamente como en una hoja de cálculo."})]}),e.jsxs("div",{className:"flex gap-2",children:[s.size>0&&e.jsxs("div",{className:"flex items-center text-amber-600 bg-amber-50 px-3 py-1 rounded-md text-sm font-medium animate-pulse",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),s.size," cambios sin guardar"]}),e.jsxs(q,{onClick:$,disabled:N||s.size===0,className:`${s.size>0?"bg-green-600 hover:bg-green-700":"bg-gray-200 text-gray-400"}`,children:[N?e.jsx(Q,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(B,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]}),e.jsxs(A,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx(K,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Filtar productos...",value:f,onChange:a=>C(a.target.value),className:"pl-8 bg-gray-50 border-gray-200"})]})}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(D,{children:[e.jsx(G,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(x,{className:"w-[40%]",children:"Producto"}),e.jsx(x,{className:"w-[20%]",children:"Precio"}),e.jsx(x,{className:"w-[20%]",children:"Stock"}),e.jsx(x,{className:"w-[20%] text-right",children:"Estado"})]})}),e.jsx(H,{children:E&&i.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center",children:"Cargando..."})}):w.length===0?e.jsx(h,{children:e.jsx(n,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No hay productos."})}):w.map(a=>{const t=s.has(a.id);return e.jsxs(h,{className:t?"bg-amber-50/50":"",children:[e.jsx(n,{className:"font-medium p-2",children:e.jsx(m,{value:a.name,onChange:r=>p(a.id,"name",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:a.price,onChange:r=>p(a.id,"price",r.target.value),className:"border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-right font-mono"})}),e.jsx(n,{className:"p-2",children:e.jsx(m,{type:"number",value:a.stock,onChange:r=>p(a.id,"stock",r.target.value),className:`border-transparent hover:border-gray-200 focus:border-blue-500 h-8 px-2 text-center ${a.stock<5?"text-red-600 font-bold":""}`})}),e.jsx(n,{className:"text-right p-2",children:t?e.jsx(S,{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50",children:"Editado"}):e.jsx(S,{variant:"outline",className:"border-gray-200 text-gray-500",children:"Sincronizado"})})]},a.id)})})]})})]})]})};export{ee as default};
