import{f as i,M as x,D as f,N as e,y as a,C as h,a as v,b as y,c as j,o as N,d as b,x as w,k as d}from"./index-87ab05f1.js";import{a as g}from"./input-977568de-bea10295-4adb3258-368f21ef-dd0395aa.js";import{o as C}from"./key-round-a0051dc5-0055dd4e-b77ebfb0-6b604475-77fe5fd5.js";import{o as z}from"./lock-7cf80104-9c8a0348-cd30842f-3c53634d-7fa9da98.js";const k=()=>{const[s,u]=i.useState(""),[n,c]=i.useState(!1),t=x(),{session:o}=f(),m=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;i.useEffect(()=>{o||window.location.hash.includes("access_token")||(e({title:"Enlace inválido",description:"El enlace de recuperación de contraseña es inválido o ha expirado.",variant:"destructive"}),t("/recuperar-contrasena"))},[o,t]);const p=async r=>{if(r.preventDefault(),!m.test(s)){e({title:"Contraseña insegura",description:"La contraseña debe tener al menos 8 caracteres, incluir una mayúscula, una minúscula, un número y un caracter especial.",variant:"destructive"});return}c(!0);const{error:l}=await d.auth.updateUser({password:s});c(!1),l?e({title:"Error al actualizar",description:l.message,variant:"destructive"}):(e({title:"¡Contraseña actualizada!",description:"Tu contraseña ha sido cambiada con éxito. Por favor, inicia sesión."}),await d.auth.signOut(),t("/cliente/login"))};return a.jsx("div",{className:"min-h-screen auth-gradient flex items-center justify-center p-4",children:a.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:a.jsxs(v,{className:"w-full bg-card text-card-foreground border-border",children:[a.jsxs(y,{className:"text-center pb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(C,{className:"h-8 w-8 text-primary"})}),a.jsx(j,{className:"text-2xl font-bold",children:"Crea tu Nueva Contraseña"}),a.jsx(N,{children:"Ingresa una nueva contraseña segura para tu cuenta."})]}),a.jsx(b,{children:a.jsxs("form",{onSubmit:p,className:"space-y-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),a.jsx(g,{type:"password",name:"password",placeholder:"Nueva Contraseña",value:s,onChange:r=>u(r.target.value),required:!0,className:"pl-10"})]}),a.jsx(w,{type:"submit",className:"w-full",disabled:n,children:n?"Actualizando...":"Actualizar Contraseña"})]})})]})})})};export{k as default};
